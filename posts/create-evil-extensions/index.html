<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Create Evil Firefox Extensions With JS-Tap Part 1" /><meta name="author" content="Zach Crosman" /><meta property="og:locale" content="en" /><meta name="description" content="The associated GitHub repository for scripts used in this blog post is located at github.com/zcrosman/firefox-extension-js-tap" /><meta property="og:description" content="The associated GitHub repository for scripts used in this blog post is located at github.com/zcrosman/firefox-extension-js-tap" /><link rel="canonical" href="https://zcrosman.github.io/posts/create-evil-extensions/" /><meta property="og:url" content="https://zcrosman.github.io/posts/create-evil-extensions/" /><meta property="og:site_name" content="Zach Crosman" /><meta property="og:image" content="https://zcrosman.github.io/images/firefox-js-tap/firefox-js-tap-small.png" /><meta property="og:image:alt" content="Firefox JS-Tap extension modification" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-25T17:32:00-06:00" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://zcrosman.github.io/images/firefox-js-tap/firefox-js-tap-small.png" /><meta name="twitter:image:alt" content="Firefox JS-Tap extension modification" /><meta property="twitter:title" content="Create Evil Firefox Extensions With JS-Tap Part 1" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Zach Crosman" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Zach Crosman"},"dateModified":"2025-08-08T08:28:43-05:00","datePublished":"2024-01-25T17:32:00-06:00","description":"The associated GitHub repository for scripts used in this blog post is located at github.com/zcrosman/firefox-extension-js-tap","headline":"Create Evil Firefox Extensions With JS-Tap Part 1","image":{"alt":"Firefox JS-Tap extension modification","url":"https://zcrosman.github.io/images/firefox-js-tap/firefox-js-tap-small.png","@type":"imageObject"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://zcrosman.github.io/posts/create-evil-extensions/"},"url":"https://zcrosman.github.io/posts/create-evil-extensions/"}</script><title>Create Evil Firefox Extensions With JS-Tap Part 1 | Zach Crosman</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Zach Crosman"><meta name="application-name" content="Zach Crosman"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://zcrosman.github.io/images/dog.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Zach Crosman</a></div><div class="site-subtitle font-italic">A Cybersecurity Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/zcrosman" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://www.linkedin.com/in/zachcrosman/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Create Evil Firefox Extensions With JS-Tap Part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Create Evil Firefox Extensions With JS-Tap Part 1</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/zcrosman">Zach Crosman</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1706225520" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-25 </em> </span> <span> Updated <em class="timeago" data-ts="1754659723" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-08-08 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1318 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><blockquote class="prompt-info"><div><p>The associated GitHub repository for scripts used in this blog post is located at <a href="https://github.com/zcrosman/firefox-extension-js-tap">github.com/zcrosman/firefox-extension-js-tap</a></p></div></blockquote><h2 id="intro"><span class="mr-2">Intro</span><a href="#intro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="https://zcrosman.github.io/images/firefox-js-tap/firefox-js-tap-small.png" alt="Logo" height="200" class="w-50 right" data-proofer-ignore> Browser extensions are like double agents in your browser - they offer handy features but often at the cost of your privacy. They can access all your online activities, and if they turn malicious or get compromised, it’s game over for your data.</p><p>Modifying browser extensions to become malicious is alarmingly easy. Extensions are built using web technologies like JavaScript, HTML, and CSS. The source code for these extensions is already stored on your computer and easy to manipulate. A hacker can inject malicious code into an otherwise benign extension by directly modifying the extension’s code to access EVERYTHING! This includes cookies, user input, local storage, and sites visited.</p><p>I’ll walk through how to create a malicious Firefox extension with a payload from <a href="https://trustedsec.com/blog/js-tap-weaponizing-javascript-for-red-teams">JS-Tap</a>. JS-Tap is a versatile JavaScript payload designed for red team operations. It’s used for attacking web applications, either as an XSS payload or as a general JavaScript payload. I’ll review how to use this with Firefox extensions so EVERY loaded page is injected and we can collect all of the valuable information from a web portal.</p><p><a href="https://github.com/hoodoer/JS-Tap#data-collected">JS-Tap is capable of collecting the following</a>:</p><ul><li>Client IP address, OS, Browser<li>User inputs (credentials, etc.)<li>URLs visited<li>Cookies (that don’t have httponly flag set)<li>Local Storage<li>Session Storage<li>HTML code of pages visited (if feature enabled)<li>Screenshots of pages visited<li>Copy of XHR API calls (if monkeypatch feature enabled)<ul><li>Endpoint<li>Method (GET, POST, etc.)<li>Headers set<li>Request body and response body</ul><li>Copy of Fetch API calls (if monkeypatch feature enabled)<ul><li>Endpoint<li>Method (GET, POST, etc.)<li>Headers set<li>Request body and response body</ul></ul><h2 id="js-tap-setup"><span class="mr-2">JS-Tap Setup</span><a href="#js-tap-setup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The JS-Tap installation has a very basic setup process. It’s important to modify the <code class="language-plaintext highlighter-rouge">telemlib.js</code> file as required in the <a href="https://github.com/hoodoer/JS-Tap#installation-and-start">setup guide</a>. Make sure that this payload is working with the tools included in <code class="language-plaintext highlighter-rouge">tools/</code> (<code class="language-plaintext highlighter-rouge">clientSimulator.py</code> &amp; <code class="language-plaintext highlighter-rouge">monkeyPatchLab.py</code>).</p><p>It’s also important to note that although I’m using JS-Tap in this walkthrough, any JavaScript payload could be interchanged with this one. This payload will be fairly persistent in the browser and constantly collecting data on every site to send back to the server. Alternatively, payloads could be set to run only a single time or target specific websites. The possibilities are endless with this type of attack.</p><h2 id="unpacking-extensions"><span class="mr-2">Unpacking Extensions</span><a href="#unpacking-extensions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The exact location of packed extensions in the Firefox application folder varies based on the operating system’s file system, with specific locations for Windows, macOS, and Linux systems:</p><ul><li><strong>Windows</strong>: <code class="language-plaintext highlighter-rouge">C:\Users\&lt;UserName&gt;\AppData\Roaming\Mozilla\Firefox\Profiles\&lt;ProfileName&gt;\extensions</code><li><strong>macOS</strong>: <code class="language-plaintext highlighter-rouge">~/Library/Application Support/Firefox/Profiles/&lt;ProfileName&gt;/extensions</code><li><strong>Linux</strong>: <code class="language-plaintext highlighter-rouge">~/.mozilla/firefox/&lt;Profile Name&gt;/extensions</code></ul><p>In these folders, Firefox extensions are packaged as <code class="language-plaintext highlighter-rouge">.xpi</code> files. This format can be unzipped to reveal all of the source code of the extension. A quick bash one-liner can be used to unpack all of these extensions in this folder:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># Unzip all of the extensions in the extensions folder</span>
<span class="k">for </span>f <span class="k">in</span> <span class="k">*</span>.xpi<span class="p">;</span> <span class="k">do </span>unzip <span class="s2">"</span><span class="nv">$f</span><span class="s2">"</span> <span class="nt">-d</span> <span class="s2">"</span><span class="k">${</span><span class="nv">f</span><span class="p">%*.xpi</span><span class="k">}</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><h2 id="extension-analysis"><span class="mr-2">Extension Analysis</span><a href="#extension-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Once all of the extensions are unpacked, we can try to find a good target. Each of the extensions contains the file <code class="language-plaintext highlighter-rouge">manifest.json</code>. This is the extension’s configuration file that includes permissions and additional extension information. Many of these extensions use an ID as the folder/extension name, which makes it slightly more confusing to tell them apart. Another bash one-liner can be used to quickly get more info about these extensions.</p><p>Quickly view the extension names and descriptions associated with each folder:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">for </span>d <span class="k">in</span> <span class="k">*</span>/<span class="p">;</span> <span class="k">do </span><span class="nb">echo</span> <span class="s2">"</span><span class="nv">$d</span><span class="s2">"</span><span class="p">;</span> jq <span class="s1">'.name, .description'</span> <span class="s2">"</span><span class="nv">$d</span><span class="s2">/manifest.json"</span><span class="p">;</span> <span class="k">done</span>
</pre></table></code></div></div><p>Example output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>------SNIP-------
87677a2c52b84ad3a151a4a72f5bd3c4@jetpack/
Grammarly: Grammar Checker and AI Writing App
Improve your writing with Grammarly's communication assistance. Spell check, grammar check, and punctuation check in one tool. Real-time suggestions for improving tone and clarity help ensure your writing makes the impression you want.
------SNIP------
"
</pre></table></code></div></div><p>Some of these configurations are interesting for this project. Further analysis can be done to view more details by manually reviewing the manifest files or using a script to display additional information.</p><p>For example, using a custom search script:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>./search-ext.sh extensions/
</pre></table></code></div></div><p>Example output:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>------SNIP-------
Directory: extensions/wappalyzer@crunchlabz.com/
Name: Wappalyzer - Technology profiler
Description: Identify web technologies
Background Scripts: not set
Content Script Matches: http://*/*, https://*/*
Content Script Exclude Matches: not set
Content Script JS: js/content.js
Permissions: cookies, storage, tabs, webRequest, http://*/*, https://*/*
------SNIP-------
</pre></table></code></div></div><p>For the rest of this walkthrough, I’ll use the Wappalyzer extension as an example. Wappalyzer is an extension that’s used to identify the technology used on websites. I want to point out some important parts of the <code class="language-plaintext highlighter-rouge">manifest.json</code> file that are crucial to the implant:</p><ul><li><code class="language-plaintext highlighter-rouge">content_scripts.matches</code> - Sites that the extension will run the specified JavaScript on<li><code class="language-plaintext highlighter-rouge">content_scripts.excludes</code> - Sites that are excluded from the JavaScript execution<li><code class="language-plaintext highlighter-rouge">content_scripts.js</code> - JavaScript files that are executed in the background of the specified sites</ul><p>In this example, all that would need to be modified is the <code class="language-plaintext highlighter-rouge">content_scripts.js</code> since it will already run on all sites.</p><h2 id="tap-that-extension"><span class="mr-2">Tap That Extension</span><a href="#tap-that-extension" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I wrote a <a href="https://github.com/zcrosman/firefox-extension-js-tap/">bash script</a> to easily update the <code class="language-plaintext highlighter-rouge">manifest.json</code> to include the necessary settings and drop the JavaScript file in the required folder. I’ll walk through how it works.</p><p>This is what part of the <code class="language-plaintext highlighter-rouge">manifest.json</code> looks like before modification for the Grammarly extension. The extension runs <code class="language-plaintext highlighter-rouge">src/js/Grammarly-check.js</code> excluding the pages in “exclude_matches”:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nl">"content_scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"all_frames"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"match_about_blank"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="nl">"css"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"src/css/Grammarly-fonts.styles.css"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"src/js/Grammarly-check.js"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"matches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"&lt;all_urls&gt;"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"exclude_matches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"*://outlook.live.com/*"</span><span class="p">,</span><span class="w">
        </span><span class="err">----SNIP----</span><span class="w">
        </span><span class="s2">"*://docs.google.com/document/*"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"exclude_globs"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="s2">"*docs.google.com*"</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="nl">"run_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"document_idle"</span><span class="w">
    </span><span class="p">}</span><span class="w">
 </span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p><strong>Updated Version:</strong></p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nl">"content_scripts"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="nl">"all_frames"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"match_about_blank"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="nl">"css"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"src/css/Grammarly-fonts.styles.css"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"src/js/Grammarly-check.js"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"js/telemlib.js"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"matches"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
            </span><span class="s2">"http://*/*"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"https://*/*"</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"run_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"document_idle"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></pre></table></code></div></div><p>The process involves injecting a JavaScript payload (like JS-Tap) into a Firefox extension. This script updates the extension’s <code class="language-plaintext highlighter-rouge">manifest.json</code> file and slips in our payload to run in the background. It also ensures that the script runs on all pages if it wasn’t configured to do so already.</p><h3 id="how-does-it-work"><span class="mr-2">How Does It Work?</span><a href="#how-does-it-work" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p><strong>Updating manifest.json</strong>: The script adds our payload to the content scripts array, telling the extension to run our malicious script on every website.</p><p><strong>Moving the Payload</strong>: The script then moves the payload (our <code class="language-plaintext highlighter-rouge">telemlib.js</code> file) to where the extension expects to find it. File location is crucial for proper execution.</p><p>The modification process involves:</p><ol><li>Loading and parsing the existing <code class="language-plaintext highlighter-rouge">manifest.json</code><li>Modifying the content scripts configuration to include our payload<li>Adding the malicious JavaScript file to the extension directory<li>Ensuring proper permissions are set for data collection</ol><h2 id="testing-your-tapped-extensions"><span class="mr-2">Testing Your Tapped Extensions</span><a href="#testing-your-tapped-extensions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>Load the Extension in Firefox</strong>: Head to <code class="language-plaintext highlighter-rouge">about:debugging</code>, click “Load Temporary Add-on”, and choose your modified <code class="language-plaintext highlighter-rouge">manifest.json</code>. Your extension now has enhanced capabilities! Once you load the extension, it will automatically be loaded into all of your existing Firefox tabs and future tabs or windows.</p><p><img data-src="https://zcrosman.github.io/images/firefox-js-tap/firefox-extension-import.png" alt="Import Extension" data-proofer-ignore></p><h3 id="see-it-in-action"><span class="mr-2">See It in Action</span><a href="#see-it-in-action" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Open Firefox’s Network tab to watch your payload in action. You can witness in real-time as your injected JavaScript interacts with each page, capturing and transmitting data seamlessly. If you’re using an unmodified JS-Tap payload, you should also see some logs in the browser console.</p><h3 id="js-tap-dashboard-filled-with-data"><span class="mr-2">JS-Tap Dashboard Filled With Data</span><a href="#js-tap-dashboard-filled-with-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Watch as data starts flooding in from the malicious extension on the JS-Tap dashboard. The dashboard becomes a hub of activity, displaying information collected from the target browser sessions.</p><p><img data-src="https://zcrosman.github.io/images/firefox-js-tap/js-tap-connections.png" alt="JS-Tap Extensions" data-proofer-ignore></p><h2 id="conclusion"><span class="mr-2">Conclusion</span><a href="#conclusion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This walkthrough demonstrates how easy it is to weaponize legitimate browser extensions for red team operations. By modifying the <code class="language-plaintext highlighter-rouge">manifest.json</code> and injecting malicious JavaScript payloads, attackers can gain persistent access to all user browsing data. This technique highlights the importance of extension security and the need for users to be cautious about the extensions they install.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/pentesting/'>Pentesting</a>, <a href='/categories/tutorial/'>Tutorial</a>, <a href='/categories/red-team/'>Red Team</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/extensions/" class="post-tag no-text-decoration" >extensions</a> <a href="/tags/javascript/" class="post-tag no-text-decoration" >javascript</a> <a href="/tags/injection/" class="post-tag no-text-decoration" >injection</a> <a href="/tags/firefox/" class="post-tag no-text-decoration" >firefox</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Create Evil Firefox Extensions With JS-Tap Part 1 - Zach Crosman&amp;url=https://zcrosman.github.io/posts/create-evil-extensions/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Create Evil Firefox Extensions With JS-Tap Part 1 - Zach Crosman&amp;u=https://zcrosman.github.io/posts/create-evil-extensions/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://zcrosman.github.io/posts/create-evil-extensions/&amp;text=Create Evil Firefox Extensions With JS-Tap Part 1 - Zach Crosman" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/create-evil-extensions/">Create Evil Firefox Extensions With JS-Tap Part 1</a><li><a href="/posts/log4j-malware/">Analyzing Log4j Malware</a><li><a href="/posts/attaacktive-directory/">TryHackMe - Attacktive Directory</a><li><a href="/posts/octospray/">Dangers of Connecting Your 3D Printer to the Internet</a><li><a href="/posts/sdctf/">SDCTF 2022</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/brute-force/">Brute Force</a> <a class="post-tag" href="/tags/c2/">C2</a> <a class="post-tag" href="/tags/crypto-miner/">crypto miner</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/cryptocurrency/">cryptocurrency</a> <a class="post-tag" href="/tags/ducky-script/">ducky script</a> <a class="post-tag" href="/tags/extensions/">extensions</a> <a class="post-tag" href="/tags/firefox/">firefox</a> <a class="post-tag" href="/tags/ghunt/">ghunt</a> <a class="post-tag" href="/tags/honeypot/">honeypot</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ducky-empire/"><div class="card-body"> <em class="timeago small" data-ts="1633299720" > 2021-10-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>How to Create a Ducky Script for Empire</h3><div class="text-muted small"><p> Physical security is a major issue in cybersecurity. A malicious actor can set up a C2 server and have full control of a computer within a few seconds with a USB rubber ducky. Once an agent is set ...</p></div></div></a></div><div class="card"> <a href="/posts/sdctf/"><div class="card-body"> <em class="timeago small" data-ts="1651707120" > 2022-05-04 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>SDCTF 2022</h3><div class="text-muted small"><p> Lots of Logs Category Difficulty Solves Points Web Easy 74 175 Challenge Description As a professional logger, I...</p></div></div></a></div><div class="card"> <a href="/posts/log4j-malware/"><div class="card-body"> <em class="timeago small" data-ts="1640302320" > 2021-12-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Analyzing Log4j Malware</h3><div class="text-muted small"><p> Intro On December 9, 2021 CVE-2021-44228 was disclosed. It is related to the log4j package that is commonly used for Java logging. This is a RCE vulnerability and attacks have been ongoing for a f...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/sdctf/" class="btn btn-outline-primary" prompt="Older"><p>SDCTF 2022</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/zcrosman">Zach Crosman</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/brute-force/">Brute Force</a> <a class="post-tag" href="/tags/c2/">C2</a> <a class="post-tag" href="/tags/crypto-miner/">crypto miner</a> <a class="post-tag" href="/tags/crypto/">Crypto</a> <a class="post-tag" href="/tags/cryptocurrency/">cryptocurrency</a> <a class="post-tag" href="/tags/ducky-script/">ducky script</a> <a class="post-tag" href="/tags/extensions/">extensions</a> <a class="post-tag" href="/tags/firefox/">firefox</a> <a class="post-tag" href="/tags/ghunt/">ghunt</a> <a class="post-tag" href="/tags/honeypot/">honeypot</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-P8R1L4DDQY"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-P8R1L4DDQY'); }); </script>
